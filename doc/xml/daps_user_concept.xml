<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet
 href="urn:x-suse:xslt:profiling:docbook45-profile.xsl" 
 type="text/xml"
 title="Profiling step"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.docbook.org/xml/4.5/docbookx.dtd"
[<!ENTITY % entities SYSTEM "entity-decl.ent">
%entities;
]>
<chapter id="cha.daps.user.oview">
 <title>Conceptual Overview</title>
 <remark>topics: daps components,
  directory structure, ENV files, profiling, validation, external components
  like XML editor and FO formatter, stylesheets ...</remark>
 <abstract>
  <para>
   The &dapslong; (&dapsacr;) is developed as open source software for Linux
   operating systems, licensed under GPL. &dapsacr; consists of integrated tools, 
   stylesheets, scripts, and makefiles that support technical writers in the 
   editing, translation and publishing process of DocBook XML files. &dapsacr; 
   supports single source publishing into a number of different output formats, 
   like PDF, HTML, single HTML, or ePUB. &dapsacr; is suited for both small
   documentation projects (created by a single author), as well as
   comprehensive documentation projects that are created by multiple authors
   in a collaborative effort.
  </para>
 </abstract>
 <sect1 id="sec.daps.user.oview.addon">
  <title>Additional Software</title>

  <para>
   &dapsacr; can be used in combination with the following software
   components:
  </para>

  <itemizedlist>
   <listitem>
    <para>
     an XML editor of your choice
    </para>
   </listitem>
   <listitem>
    <para>
     an FO formatter (like FOP or XEP)
    </para>
   </listitem>
   <listitem>
    <para>
     any version management system, like CVS, Subversion, Mercurial or Git
    </para>
   </listitem>
   <listitem>
    <para>&dm; (if you want to add a workflow and management component). You can
    use &dm; to add and retrieve meta-information for all files belonging to a 
    documentation project. &dm; is especially useful for larger, collaborative 
    projects where it helps you to keep track of owners (authors) and editing 
    status of all files. <remark>taroth 2012-02-07: todo - add xref to separate
  dm; guide</remark>
    </para>
   </listitem>
  </itemizedlist>

  <para>
   Together with the software components mentioned above, &dapsacr; can be
   used as a fully-fledged authoring and content management system for documentation
   projects based on DocBook.
  </para>
 </sect1>
 <sect1 id="sec.daps.user.oview.concepts">
  <title>&dapsacr; Variables</title>

  <para>
   To define the build environment to use, &dapsacr; uses a set of parameters
   that can be set in various places:
  </para>

  <itemizedlist>
   <listitem>
    <para>
     &dapsconf; (system-wide configuration file)
    </para>
   </listitem>
   <listitem>
    <para>
     &dapsconfu; (user-specific configuration file)
    </para>
   </listitem>
   <listitem>
    <para>
     &env; file of the documentation project (usually for project- or
     book-specific settings)
    </para>
   </listitem>
   <listitem>
    <para>
     on the fly at the command line. You can specify them either as as
     options to a <command>daps</command> or as variable declaration
     (<varname>FOO=bar</varname>).
    </para>
   </listitem>
  </itemizedlist>

  <para>
   The configuration file &dapsconf; lists all keys that can be used,
   including a short description for each key.
  </para>
 </sect1>
 <sect1 id="sec.daps.user.oview.docproject">
  <title>Defining Documentation Projects</title>

  <para>The following files are the key files for defining a documentation
   project so that it can be processed by &dapsacr;:</para>

  <variablelist>
   <varlistentry>
    <term>
     <xref linkend="sec.daps.user.oview.docproject.main" xrefstyle="select:title"/>
    </term>
    <listitem>
     <para>An XML file containing the <quote>starting point</quote> (root ID) 
    of your documentation project (<sgmltag>book</sgmltag>, 
    <sgmltag>article</sgmltag>, or <sgmltag>set</sgmltag>). 
    For larger documentation projects, it is good practice to name the file 
    <filename>MAIN-<replaceable>PROJECTNAME</replaceable>.xml</filename>, 
    but you can use any other filename as well.</para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>&env; File</term>
    <listitem>
     <para>A text file defining a number of parameters for your 
   documentation project (like which <parameter>ROOTID</parameter>, which layout, 
   or which profiling information to use).</para>
    </listitem>
   </varlistentry>
  </variablelist>
  <sect2 id="sec.daps.user.oview.docproject.main">
   <title>Main File</title>
   <para>Find an example main file for a book below. In the example file, the 
   chapters of the book are included via Xincludes. <remark>taroth 2012-02-08: 
   this might be too scary already for newbies - todo: better use example MAIN
   that is used for daps init</remark> </para>
   <example id="ex.daps.main">
    <title>Main File of a Book</title>
    <screen>	
&lt;!-- ##################################################################### --&gt;
&lt;!-- SLE HA High Availability Guide --&gt;
&lt;!-- ##################################################################### --&gt;
   	&lt;book lang="en" id="book.sleha"&gt;
    	&lt;bookinfo&gt;
      	&lt;title&gt;&amp;haguide;&lt;/title&gt;
      	&lt;productname&gt;&amp;productname;&lt;/productname&gt;
 	      &lt;productnumber&gt;&amp;productnumber;&lt;/productnumber&gt;
       	&lt;xi:include href="common_copyright_gfdl.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
   	  &lt;/bookinfo&gt;
    &lt;xi:include href="ha_intro.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
&lt;!-- ===================================================================== --&gt;
&lt;!-- Part: Installation and Setup --&gt;
&lt;!-- ===================================================================== --&gt;
	 &lt;part id="part.install"&gt;
 	&lt;title&gt;Installation and Setup&lt;/title&gt;
	&lt;xi:include href="ha_concepts.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
	&lt;xi:include href="ha_installation.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;/part&gt;
 	&lt;!-- ===================================================================== --&gt;
 	&lt;!-- Part: Configuration and Administration --&gt;
 	&lt;!-- ===================================================================== --&gt;
 	&lt;part id="part.config"&gt;
 	&lt;title&gt;Configuration and Administration&lt;/title&gt;
 	&lt;xi:include href="ha_config_basics.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;xi:include href="ha_config_gui.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;xi:include href="ha_config_cli.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
	&lt;xi:include href="ha_config_hawk.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;xi:include href="ha_agents.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;xi:include href="ha_fencing.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;xi:include href="ha_lvs.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;xi:include href="ha_netbonding.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;/part&gt;
 	&lt;!-- ===================================================================== --&gt;
 	&lt;!-- Part: Storage and Data Replication --&gt;
 	&lt;!-- ===================================================================== --&gt;
 	&lt;part id="part.storage"&gt;
 	&lt;title&gt;Storage and Data Replication&lt;/title&gt;
 	&lt;xi:include href="ha_ocfs2.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;xi:include href="ha_drbd.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;xi:include href="ha_clvm.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;xi:include href="ha_storage_protection.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;xi:include href="ha_samba.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;/part&gt;
 	&lt;!-- ===================================================================== --&gt;
 	&lt;!-- Part: Troubleshooting and Reference --&gt;
	&lt;!-- ===================================================================== --&gt;
 	&lt;part id="part.reference"&gt;
 	&lt;title&gt;Troubleshooting and Reference&lt;/title&gt;
 	&lt;xi:include href="ha_troubleshooting.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;xi:include href="ha_agentlist_details.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;/part&gt;
 	&lt;!-- ===================================================================== --&gt;
 	&lt;!-- Part: Appendix --&gt;
 	&lt;!-- ===================================================================== --&gt;
 	&lt;part id="part.appendix"&gt;
 	&lt;title&gt;Appendix&lt;/title&gt;
	&lt;xi:include href="ha_example.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;xi:include href="ha_migration.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;xi:include href="ha_news.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;/part&gt;
	&lt;xi:include href="ha_glossary.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/&gt;
 	&lt;/book&gt;
</screen>

   </example>
   <para>If your documentation project consists of multiple 
   books and articles in a  <sgmltag>set</sgmltag>, the main file is the one 
   that contains the <sgmltag>set</sgmltag> element.</para>
  </sect2>

  <sect2 id="sec.daps.user.oview.docproject.env">
  <title>&env; File</title>
  
  <para>  
   For a documentation set (a collection of books), multiple &env; files can
   be defined. This allows you to set different parameters (or different
   values) for individual books of the set: For example, by referring a
   different <parameter>ROOTID</parameter> in an &env; file, you define which
   book of the set is to be built. Another example would be to specify
   different layouts.
  </para>

  <example id="ex.daps.env.user">
   <title>An <filename>&env;-*</filename> File For a Book</title>
   <screen># &env; file for &dapsacr; User Guide
<co id="co.daps.main"/> MAIN=MAIN.DAPS.xml         
<co id="co.daps.rootid"/> ROOTID=book_daps_user.xml 
<co id="co.daps.profarch"/> PROFARCH="x86;ppc"         
<co id="co.daps.profos"/> PROFOS="lin;win"           
<co id="co.daps.layout"/> LAYOUT=                   
<co id="co.daps.productname.version"/> PRODUCTNAME="&dapslong;"   
<xref linkend="co.daps.productname.version"/> DISTVER=1.0

<co id="co.daps.source"/> export DAPS_ENV_NAME=$(basename $BASH_SOURCE) 
    </screen>
  </example>

  <calloutlist>
   <callout arearefs="co.daps.main">
    <para>
     Mandatory parameter. Sets the main file that contains
     <quote>references</quote> to other books, chapters, appendices, etc. 
    </para>
   </callout>
   <callout arearefs="co.daps.rootid">
    <para>
     Optional parameter. Defines the root ID of the element to be used for
     creating an output format. Usually, you define the root ID of a
     <sgmltag>book</sgmltag> or <sgmltag>article</sgmltag>
     element here.
    </para>
   </callout>
   <callout arearefs="co.daps.profarch">
    <para>
     Optional parameters. If you have similar products to document and 
     want to generate multiple documentation variants from your XML files, you 
     can do so with the help of conditional text (or profiling, as it is called in DocBook). 
     To profile your output for different (processor) architectures (like x86) or operating 
     systems (like Windows or Linux), use those parameters to select the information 
     that should be included.
    </para>
   </callout>
   <callout arearefs="co.daps.profos">
    <para>
     Optional parameter.If you want to profile your text for different
     operating systems (for example, for Linux and Windows), this variable
     selects the operating system profiling information.
    </para>
   </callout>
   <callout arearefs="co.daps.layout">
    <para>
     Optional parameter. Determines the layout of the book. Per default,
     &dapsacr; ships the following layouts:
     <remark>taroth 2012-01-19: bound to change soon, therefore commenting 
     for now</remark>
    </para>
<!--<variablelist>
     <varlistentry>
      <term>
       <option>flyer</option>
      </term>
      <listitem>
       <para>Creates a flyer layout that can be used for Quick Starts.</para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>
       <option>pocket</option>
      </term>
      <listitem>
       <para>Creates a pocket layout which a smaller page format.</para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Empty, no value</term>
      <listitem>
       <para>Selects the default layout.<remark>taroth 2011-12-29: 
            =layout of SUSE manuals? where is the default defined?</remark>
       </para>
      </listitem>
     </varlistentry>
    </variablelist>-->
   </callout>
   <callout arearefs="co.daps.productname.version">
    <para>
     Optional parameters.
     <remark>taroth 2012-01-19: name DISTVER 
     will probably change - https://sourceforge.net/p/daps/tickets/25/</remark>
     &dapsacr; allows you to set product name and product version
     dynamically. This enables you to use the same XML sources for different
     products. To use this feature, use the following entities in your XML
     sources:
    </para>
    <itemizedlist>
     <listitem>
      <para>
       &amp;productname;
      </para>
     </listitem>
     <listitem>
      <para>
       &amp;productnamereg; (productname including a copyright or trademark
       symbol)
      </para>
     </listitem>
     <listitem>
      <para>
       &amp;productversion;
      </para>
     </listitem>
    </itemizedlist>
    <para>
     These entities will be dynamically resolved to the values of the
     parameters <parameter>DISTVER</parameter>, <parameter>PRODUCTNAME</parameter>,
     and <parameter>PRODUCTNAMEREG</parameter>. You can define the value of
     those parameters in a project-specific (or book-specific) &env; file.
     <remark>taroth 2012-01-30</remark>
<!--# Example:
#   PRODUCTNAME="MyVeryFirstSoftware"
#   PRODUCTNAME="MyVeryFirstSoftwareÂ©"
#   DISTVER="4.2"
-->
    </para>
   </callout>
   <callout arearefs="co.daps.source">
    <para>
     Optional line. You only need to add this line if you want to be able to
     source &env; files with &dapsacr;. Sourcing an &env; file was necessary
     to work with the documentation environment provided by &susedoc;
     (&dapsacr;' predecessor).
    </para>
   </callout>
  </calloutlist>

  <para>Of the parameters in the &env;, the only one required is 
  <parameter>MAIN</parameter>. If you do not want to set any other parameters, 
  you can also set the <parameter>MAIN</parameter> parameter on the command line
  and do without &env;.</para>

  <para>
   Because &env; files define the <quote>starting point</quote> of your 
   documentation (by referencing the <parameter>MAIN</parameter> parameter), 
   they are necessary for validating your XML files and for
   generating any kind of output. Without &env; files, you cannot produce
   any output from your DocBook sources with &dapsacr;.
   <remark>taroth 2012-01-17: not 100% sure if this is still the
case</remark>
   <remark>toms 2012-02-08: I think, your last sentence beginning with
      "Without..." is correct.</remark>
  </para>

  <para>
   If your documentation set contains cross-references between the
   individual books, it is useful to define an additional &env; file
   (<emphasis>without</emphasis> the <parameter>ROOTID</parameter> parameter)
   that can be used to generate an HTML output containing all hyperlinks
   between the individual books. Find an example &env; file in
   <xref linkend="ex.daps.env.set"/>.
  </para>

  <example id="ex.daps.env.set">
   <title>An <filename>&env;-*</filename> File for a Set</title>
   <screen># &env; file for the complete &dapsacr; Documentation
MAIN=MAIN.DAPS.xml         
PROFARCH="x86;ppc"         
PROFOS="lin;win"           
LAYOUT=                    
PRODUCTNAME="&dapslong;"   
DISTVER=1.0                

export DAPS_ENV_NAME=$(basename $BASH_SOURCE) </screen>
  </example>

  <para>
   &dapsacr; also contains a script for creating a new documentation project
   from scratch.
   <remark>taroth 2011-12-29: add xref later</remark>
   When using that script, an example &env; file is automatically created.
  </para>
  </sect2>
 </sect1>
 <sect1 id="sec.daps.user.oview.dirstruct">
  <title>Directory Structure</title>

  <para>
   For &dapsacr; to work out of the box, your XML files and images should be
   organized within your documentation directory (DOC_DIR) as shown in
   <xref linkend="ex.daps.user.dir.doc"/>.
  </para>

  <sect2 id="sec.daps.user.oview.dir.doc">
   <title>Documentation Source Files</title>
   <para>
    <xref linkend="ex.daps.user.dir.doc"/> also shows the key files of a
    documentation project. The directories are printed in bold.
   </para>
   <remark>toms 2012-02-08: IMHO, it looks better to have the callouts
      *after* the term. This avoids unaligned characters (as the callout
    is usually a bit wider)</remark>
   <example id="ex.daps.user.dir.doc">
    <title>Directory Structure</title>
    <screen>
     <co id="co.docdir.base"/>
     <replaceable>YOUR_DOC_DIR</replaceable>
<co id="co.docdir.env"/> |--&env;*
<co id="co.docdir.img"/> |--<emphasis role="bold">images</emphasis>
<co id="co.docdir.img.src"/>    |-- <emphasis role="bold">src</emphasis>
         |--<emphasis role="bold">dia</emphasis>
         |--<emphasis role="bold">fig</emphasis>
         |--<emphasis role="bold">png</emphasis>
         |--<emphasis role="bold">svg</emphasis>
<co id="co.docdir.xml"/> |--<emphasis role="bold">xml</emphasis>
<co id="co.docdir.main"/>    |--MAIN*.xml</screen>
   </example>
   <calloutlist>
    <callout arearefs="co.docdir.base">
     <para>
      <quote>Working directory</quote> for the respective documentation project. Can be
      set on the command line with <option>--basedir</option> or in the
      &dapsacr; config files (usually in the user-specific one,
      &dapsconfu;).
     </para>
    </callout>
    <callout arearefs="co.docdir.env">
     <para>
      &env; file defining the documentation project. For more information,
      refer to <xref linkend="sec.daps.user.oview.docproject"/>.
     </para>
    </callout>
<!--<callout arearefs="co.daps.user.dir.img">
     <para>Top-level directory for the images used in the documentation project.
      </para>
    </callout>-->
    <callout arearefs="co.docdir.img.src">
     <para>
      Top-level directory for any original images that you want to use in
      the documentation project. Contains subdirectories for images in
      various formats. Any images to be referenced in the XML sources must
      be put in the respective subdirectories.
      <remark>taroth 2012-02-01: add xref to 
     section about using images (how to reference them -> path!)</remark>
     </para>
    </callout>
    <callout arearefs="co.docdir.xml">
     <para>
      Directory holding the XML files for the documentation project. If you
      declare entities in an external file (for example, in
      <filename>entity-decl.ent</filename>), put the entity declaration file
      here, too.
      <remark>taroth 2012-02-01: toms, this is not a must, or is it?</remark>
      <remark>toms 2012-02-08: It is a must, if you define entities.
         Otherwise not, of course. :)</remark>
     </para>
    </callout>
    <callout arearefs="co.docdir.main">
     <para>
      The main file of the documentation project. It contains
      <quote>references</quote> to other books, chapters, appendices, etc.
     </para>
    </callout>
   </calloutlist>
  </sect2>

  <sect2 id="sec.daps.user.oview.dir.build">
   <title>Structure Created by &dapsacr;</title>
   <para>
    When generating the first output format from your documentation project,
    &dapsacr; adds another directory that holds the generated contents. It
    is named <filename>build</filename> (if not set otherwise in &dapsconf;,
    parameter <parameter>BUILD_DIR</parameter>), and is created in parallel to
    the <filename>xml</filename> and <filename>images</filename> directory.
   </para>
   <para>
    The contents of the <filename>build</filename> directory is structured
    as follows:
   </para>
   <remark>toms 2012-02-08: This looks garbled :)</remark>
   <example id="ex.daps.user.build">
    <title>Build Directory</title>
    <screen>
     <co id="co.builddir"/> |--<emphasis role="bold">build</emphasis>
     <co id="co.builddir.env"/>    |--<emphasis role="bold"><replaceable>NAME_OF_&env;1</replaceable>
     </emphasis>
     <xref linkend="co.builddir.env"/>    |--<emphasis role="bold"><replaceable>NAME_OF_&env;2</replaceable>
     </emphasis>
     <co id="co.builddir.img"/>    |--<emphasis role="bold">.images</emphasis>
     <co id="co.builddir.profiled"/>    |--<emphasis role="bold">.profiled</emphasis>
     <co id="co.builddir.tmp"/>    |--<emphasis role="bold">.tmp</emphasis>
    </screen>
   </example>
   <calloutlist>
    <callout arearefs="co.builddir">
     <para>
      Directory that holds all contents build by &dapsacr;.
     </para>
    </callout>
    <callout arearefs="co.builddir.env">
     <para>
      For each of your documentation projects, &dapsacr; creates a
      subdirectory, named after the respective &env; from which you build
      the project. All formats that have been generated from the &env; (PDF,
      HTML, TXT, ePUB etc.) can be found there. A <filename>log</filename>
      subdirectory stores log files for each output format that has been
      generated by &dapsacr;.
     </para>
    </callout>
    <callout arearefs="co.builddir.img">
     <para>
      Directory holding the images created by &dapsacr;.
     </para>
    </callout>
    <callout arearefs="co.builddir.profiled">
     <para>
      Directory holding the profiled XML sources created by &dapsacr;.
     </para>
    </callout>
    <callout arearefs="co.builddir.tmp">
     <para>
      Directory holding temporary files created by &dapsacr;(for example,
      the FO files).
     </para>
    </callout>
   </calloutlist>
  </sect2>
 </sect1>
</chapter>
